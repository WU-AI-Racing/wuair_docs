"use strict";(globalThis.webpackChunkwuair_docs=globalThis.webpackChunkwuair_docs||[]).push([[9053],{2639(e,n,s){s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"Development/style-guide","title":"ROS Python Development & Style Guide","description":"To maintain a clean, stable, and readable codebase, all contributors must adhere to the following development guidelines.","source":"@site/docs/Development/style-guide.md","sourceDirName":"Development","slug":"/Development/style-guide","permalink":"/wuair_docs/docs/Development/style-guide","draft":false,"unlisted":false,"editUrl":"https://github.com/WU-AI-Racing/wuair_docs.git/docs/Development/style-guide.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"setting-up-repos","permalink":"/wuair_docs/docs/Development/setting-up-repos"},"next":{"title":"Perception","permalink":"/wuair_docs/docs/category/perception"}}');var t=s(4848),l=s(8453);const r={sidebar_position:2},a="ROS Python Development & Style Guide",o={},d=[{value:"1. Version Control &amp; Git Workflow",id:"1-version-control--git-workflow",level:2},{value:"Main Branch is Sacred",id:"main-branch-is-sacred",level:3},{value:"Branching Strategy",id:"branching-strategy",level:3},{value:"Commit Messages",id:"commit-messages",level:3},{value:"2. ROS Parameters vs. Hardcoded Values",id:"2-ros-parameters-vs-hardcoded-values",level:2},{value:"If a variable might need to be changed during testing (e.g., speed, PID constants, topic names, timers), it <strong>must</strong> be a ROS parameter.",id:"if-a-variable-might-need-to-be-changed-during-testing-eg-speed-pid-constants-topic-names-timers-it-must-be-a-ros-parameter",level:3},{value:"Example",id:"example",level:3},{value:"3. No &quot;Magic Numbers&quot;",id:"3-no-magic-numbers",level:2},{value:"4. Modularity &amp; Functions",id:"4-modularity--functions",level:2},{value:"Split code into reusable, logical blocks. A function should do one thing well.",id:"split-code-into-reusable-logical-blocks-a-function-should-do-one-thing-well",level:3},{value:"5. Python Coding Standards (PEP 8)",id:"5-python-coding-standards-pep-8",level:2},{value:"6. Logging",id:"6-logging",level:2}];function c(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"ros-python-development--style-guide",children:"ROS Python Development & Style Guide"})}),"\n",(0,t.jsx)(n.p,{children:"To maintain a clean, stable, and readable codebase, all contributors must adhere to the following development guidelines."}),"\n",(0,t.jsx)(n.h2,{id:"1-version-control--git-workflow",children:"1. Version Control & Git Workflow"}),"\n",(0,t.jsx)(n.h3,{id:"main-branch-is-sacred",children:"Main Branch is Sacred"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"main"})," (or ",(0,t.jsx)(n.code,{children:"master"}),") branch should ",(0,t.jsx)(n.strong,{children:"always"})," be deployable and compilable."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"NEVER"})," push experimental code directly to ",(0,t.jsx)(n.code,{children:"main"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"NEVER"})," commit broken code to ",(0,t.jsx)(n.code,{children:"main"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"branching-strategy",children:"Branching Strategy"}),"\n",(0,t.jsx)(n.p,{children:"Create a new branch for every feature, bug fix, or experiment. Use descriptive prefixes:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"feature/add-lidar-node"})," (New functionality)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"fix/camera-latency"})," (Bug repair)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"experiment/new-pid-tuning"})," (Testing ideas that might not work)"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"commit-messages",children:"Commit Messages"}),"\n",(0,t.jsxs)(n.p,{children:["Commit messages must be descriptive. A commit message should tell us ",(0,t.jsx)(n.em,{children:"what"})," changed and ",(0,t.jsx)(n.em,{children:"why"}),", not just that files were modified."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Bad:"})," ",(0,t.jsx)(n.code,{children:"fix"}),", ",(0,t.jsx)(n.code,{children:"update"}),", ",(0,t.jsx)(n.code,{children:"working on stuff"}),", ",(0,t.jsx)(n.code,{children:"typo"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Good:"})," ",(0,t.jsx)(n.code,{children:"Fix lidar timestamp synchronization issue"}),", ",(0,t.jsx)(n.code,{children:"Add ROS parameter for max_speed"}),", ",(0,t.jsx)(n.code,{children:"Refactor image processing into separate function"})]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"2-ros-parameters-vs-hardcoded-values",children:"2. ROS Parameters vs. Hardcoded Values"}),"\n",(0,t.jsx)(n.p,{children:"Hardcoding values makes code rigid and requires recompilation/edits to change behavior."}),"\n",(0,t.jsxs)(n.h3,{id:"if-a-variable-might-need-to-be-changed-during-testing-eg-speed-pid-constants-topic-names-timers-it-must-be-a-ros-parameter",children:["If a variable might need to be changed during testing (e.g., speed, PID constants, topic names, timers), it ",(0,t.jsx)(n.strong,{children:"must"})," be a ROS parameter."]}),"\n",(0,t.jsx)(n.h3,{id:"example",children:"Example"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"\u274c BAD (Hardcoded):"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"class Mover(Node):\n    def timer_callback(self):\n        # If we want to change speed, we have to edit the code!\n        msg.linear.x = 0.5 \n        self.publisher.publish(msg)\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u2705 GOOD (ROS Parameters):"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"\nclass Mover(Node):\n    def __init__(self):\n        super().__init__('mover')\n        # Declare the parameter with a default value\n        self.declare_parameter('target_speed', 0.5)\n\n    def timer_callback(self):\n        # Get the current value (can be changed live via command line or launch file)\n        speed = self.get_parameter('target_speed').value\n        msg.linear.x = speed\n        self.publisher.publish(msg)\n"})}),"\n",(0,t.jsx)(n.h2,{id:"3-no-magic-numbers",children:'3. No "Magic Numbers"'}),"\n",(0,t.jsx)(n.p,{children:'A "Magic Number" is a raw number used in code without context. It confuses readers and makes updating math difficult.'}),"\n",(0,t.jsx)(n.p,{children:"The Rule"}),"\n",(0,t.jsx)(n.p,{children:"Replace magic numbers with named constants (UPPER_CASE) or ROS parameters."}),"\n",(0,t.jsx)(n.p,{children:"\u274c BAD:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# What does 1.57 mean? Why 0.3?\nif distance < 0.3:\n    turn_angle = 1.57\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u2705 GOOD:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"\nimport math\n\nSTOP_DISTANCE_M = 0.3\nTURN_ANGLE_RAD = math.pi / 2  # 90 degrees\n\nif distance < STOP_DISTANCE_M:\n    turn_angle = TURN_ANGLE_RAD\n"})}),"\n",(0,t.jsx)(n.h2,{id:"4-modularity--functions",children:"4. Modularity & Functions"}),"\n",(0,t.jsx)(n.p,{children:'Do not write "God Functions." A single function (especially a ROS callback) should not handle logic, calculation, logging, AND publishing.'}),"\n",(0,t.jsx)(n.h3,{id:"split-code-into-reusable-logical-blocks-a-function-should-do-one-thing-well",children:"Split code into reusable, logical blocks. A function should do one thing well."}),"\n",(0,t.jsx)(n.p,{children:'\u274c BAD (The "Everything" Callback):'}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"\ndef image_callback(self, msg):\n    # 50 lines of code converting image\n    # 20 lines of code detecting red pixels\n    # 10 lines of code calculating center point\n    # 5 lines of code publishing\n    pass\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u2705 GOOD (Modular):"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"\ndef image_callback(self, msg):\n    cv_image = self.convert_ros_to_cv2(msg)\n    center_point = self.detect_red_object(cv_image)\n    \n    if center_point:\n        self.publish_drive_command(center_point)\n\ndef convert_ros_to_cv2(self, msg):\n    # Only handles conversion\n    return cv_bridge.imgmsg_to_cv2(msg)\n\ndef detect_red_object(self, image):\n    # Only handles detection logic\n    # This logic can now be unit tested easily!\n    return (x, y)\n"})}),"\n",(0,t.jsx)(n.h2,{id:"5-python-coding-standards-pep-8",children:"5. Python Coding Standards (PEP 8)"}),"\n",(0,t.jsx)(n.p,{children:"We follow standard Python PEP 8 style guides."}),"\n",(0,t.jsxs)(n.p,{children:["Classes: CamelCase (e.g., ",(0,t.jsx)(n.code,{children:"class CameraNode(Node)"}),":)"]}),"\n",(0,t.jsxs)(n.p,{children:["Functions/Variables: snake_case (e.g., ",(0,t.jsx)(n.code,{children:"def calculate_speed():, lidar_data = ..."}),")"]}),"\n",(0,t.jsxs)(n.p,{children:["Constants: UPPER_CASE (e.g., ",(0,t.jsx)(n.code,{children:"MAX_RPM = 5000"}),")"]}),"\n",(0,t.jsx)(n.h2,{id:"6-logging",children:"6. Logging"}),"\n",(0,t.jsx)(n.p,{children:"Don't use Python's print() function. Use the ROS logger. print() output often gets lost in ROS launch logs and doesn't support severity levels."}),"\n",(0,t.jsx)(n.p,{children:"\u274c BAD:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'print("Starting the robot...")\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u2705 GOOD:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'self.get_logger().info("Starting the robot...")\nself.get_logger().warn("Battery low!")\nself.get_logger().error("Sensor connection failed.")\n'})})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453(e,n,s){s.d(n,{R:()=>r,x:()=>a});var i=s(6540);const t={},l=i.createContext(t);function r(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);