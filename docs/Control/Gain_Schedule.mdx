---
sidebar_position: 5
---
# Gain scheduling
:::note Accessibility
If math images are not rendering, a pre-compiled PDF version of this page is available [here](/Controls_Access/notes.pdf).
:::
## syms matlab, linearization
### Video Lecture
I link below a short (and dense) example of the Linearization of a
nonlinear set of dynamics using both MATLAB syms and a manual method:
[Linerization Example with syms in MATLAB](https://www.youtube.com/watch?v=UQpt7qJdd1I)
### Definitions
We are some system described by the following equation, for state ![x](https://latex.codecogs.com/svg.image?\color%7Bwhite%7Dx)
and input ![u](https://latex.codecogs.com/svg.image?\color%7Bwhite%7Du):

![\dot x = f(x,u)](https://latex.codecogs.com/svg.image?\color%7Bwhite%7D\dot%7Bx%7D=f(x,u))

where our linearization is defined, about a linearization point
![(x_0,u_0)](https://latex.codecogs.com/svg.image?\color%7Bwhite%7D(x_0,u_0)):

![\dot x \approx f + jacobians](https://latex.codecogs.com/svg.image?\color%7Bwhite%7D\dot%7Bx%7D(x,u)\approx%20f(x_0,u_0)+\left.\frac%7B\partial%20f%7D%7B\partial%20x%7D\right\vert_%7Bx_0,u_0%7D(x-x_0)+\left.\frac%7B\partial%20f%7D%7B\partial%20u%7D\right\vert_%7Bx_0,u_0%7D(u-u_0))

The jacobians are redefined to be ![A(x_0,u_0)](https://latex.codecogs.com/svg.image?\color%7Bwhite%7DA(x_0,u_0)) and ![B(x_0,u_0)](https://latex.codecogs.com/svg.image?\color%7Bwhite%7DB(x_0,u_0)) in
order of appearance. We can then group terms and define
![\Delta x, \Delta u](https://latex.codecogs.com/svg.image?\color%7Bwhite%7D(\Delta%20x,\Delta%20u):=(x-x_0,u-u_0)), such that:

![\Delta \dot x = A\Delta x + B\Delta u](https://latex.codecogs.com/svg.image?\color%7Bwhite%7D\Delta\dot%7Bx%7D=A\Delta%20x+B\Delta%20u)

Note the linearity of the derivative, such that
![\frac{d\Delta x}{dt} = \Delta \frac{dx}{dt}](https://latex.codecogs.com/svg.image?\color%7Bwhite%7D\frac%7Bd\Delta%20x%7D%7Bdt%7D=\Delta\frac%7Bdx%7D%7Bdt%7D).

## full state feedback
### Definitions
I will assume you have seen or understand the prior definitions for the
linearization of our nonlinear dynamics. Given them, we define full
state feedback as such:

![u = -K^Tx](https://latex.codecogs.com/svg.image?\color%7Bwhite%7Du=-K^Tx\implies\Delta\dot%7Bx%7D=(A-BK^T)\Delta%20x)

It should be noted ![u_0 = -K^Tx_0](https://latex.codecogs.com/svg.image?\color%7Bwhite%7Du_0=-K^Tx_0) implies ![\Delta u = -K^T\Delta x](https://latex.codecogs.com/svg.image?\color%7Bwhite%7D\Delta%20u=-K^T\Delta%20x).
The matrix ![A-BK^T](https://latex.codecogs.com/svg.image?\color%7Bwhite%7DA-BK^T)'s eigenvalues decide directly the settling time
and stability margins for our linear system. Because our system is
heavily nonlinear and MIMO (Multiple Input, Multiple Output), we cannot
simply solve for the eigenvalues and remain computationally efficient.
Instead, we can use `place()` in MATLAB or python control
packages to automate these processes.
There are conditions to this process, one such one being the linear
system be controllable, a key failure of gain scheduling.

## Iterative Eigenvalue Manipulation
Now that we can know the form of the matrix to solve for and have a
method to solve for the gain matrix ![K](https://latex.codecogs.com/svg.image?\color%7Bwhite%7DK), we must build our pipeline.
```text
function getNewControl(f,x)
    Given dynamics f, current state x,
    linearize f about x,
    solve for desired eigenvalues,
    return controller u=-K^Tx
```

# General Tools
## MATLAB
[syms MATLAB help page](https://www.mathworks.com/help/symbolic/syms.html)

[ode45 MATLAB help page](https://www.mathworks.com/help/matlab/ref/ode45.html)

[Pole Placement MATLAB Tutorial (Eigenvalue Manipulation)](https://www.youtube.com/watch?v=FXSpHy8LvmY)
```
